---
title: 06-10
description: "06-10 çš„ç”Ÿæ´»è®°å½•"
pubDate: 2025-06-10
image: /images/blog/default.png
categories:
  - life
tags:
  - day
---
ğŸ“… **æ—¶é—´**: 10:47
ğŸŒ¤ï¸ **å¤©æ°”**: é“¶å· 20~33â„ƒ æ™´

> åˆæƒŠæ²³æ±‰è½ï¼ŒåŠæ´’äº‘å¤©é‡Œã€‚

<cite style="text-align: right; display: block;">â€” æç™½ Â· ã€Šæœ›åºå±±ç€‘å¸ƒæ°´äºŒé¦–ã€‹</cite>

## æ­£æ–‡

obsidianæ¨¡æ¿

```
<%*
// ================== è¾…åŠ©å‡½æ•°ï¼Œå¢åŠ å¥å£®æ€§ ==================
// è·å–å¤©æ°”ä¿¡æ¯ï¼Œå¢åŠ äº†å®Œæ•´çš„é”™è¯¯å¤„ç†
async function getWeather(cityName = 'yinchuan', cityLabel = 'é“¶å·') {
    try {
        const url = `https://www.tianqi.com/${cityName}/`;
        // è®¾ç½®è¶…æ—¶ï¼Œé˜²æ­¢è¯·æ±‚å¡æ­»
        const res = await request({ url: url, method: "GET" });
        
        if (!res) return `${cityLabel} å¤©æ°”è·å–å¤±è´¥`;

        const cleanedHtml = res.replace(/\s/g, '');
        
        const weatherContainerMatch = /<ddclass="weather">.*?<\/dd>/.exec(cleanedHtml);
        if (!weatherContainerMatch) return `${cityLabel} å¤©æ°”æ•°æ®è§£æå¤±è´¥ (å®¹å™¨æœªæ‰¾åˆ°)`;
        
        const weatherDetailsMatch = /<span><b>(.*?)<\/b>(.*?)<\/span>/.exec(weatherContainerMatch[0]);
        if (!weatherDetailsMatch || !weatherDetailsMatch[1] || !weatherDetailsMatch[2]) {
            return `${cityLabel} å¤©æ°”æ•°æ®è§£æå¤±è´¥ (è¯¦æƒ…æœªæ‰¾åˆ°)`;
        }
        
        return `${cityLabel} ${weatherDetailsMatch[2]} ${weatherDetailsMatch[1]}`;
    } catch (error) {
        console.error("è·å–å¤©æ°”æ—¶å‡ºé”™:", error);
        return `${cityLabel} å¤©æ°”è·å–å¼‚å¸¸`;
    }
}
// è·å–è¯—è¯ï¼Œå¢åŠ äº†å®Œæ•´çš„é”™è¯¯å¤„ç†
async function getDailyPoem(tp) {
    try {
        const response = await tp.obsidian.request({ url: 'https://v1.jinrishici.com/all.json' });
        const data = JSON.parse(response);
        if (data && data.content) {
            return `> ${data.content}\n\n<cite style="text-align: right; display: block;">â€” ${data.author} Â· ã€Š${data.origin}ã€‹</cite>`;
        }
        return "> è¿œæ–¹ä¼ æ¥é£ç¬›ï¼Œè€Œæˆ‘åªåœ¨æ„ä½ ã€‚"; // å¤±è´¥æ—¶çš„ä¼˜ç¾é™çº§æ–‡æ¡ˆ
    } catch (error) {
        console.error("è·å–è¯—è¯æ—¶å‡ºé”™:", error);
        return "> è¿œæ–¹ä¼ æ¥é£ç¬›ï¼Œè€Œæˆ‘åªåœ¨æ„ä½ ã€‚"; // å¤±è´¥æ—¶çš„ä¼˜ç¾é™çº§æ–‡æ¡ˆ
    }
}
// ================== ä¸»æµç¨‹å¼€å§‹ ==================
// 1. è·å–å¹¶æ ¡éªŒæ—¥æœŸ
const today = tp.date.now("YYYY-MM-DD");
const inputDateStr = await tp.system.prompt("è¾“å…¥æ—¥æœŸï¼ˆæ ¼å¼ï¼šYYYY-MM-DDï¼‰", today);
const momentDate = window.moment(inputDateStr, "YYYY-MM-DD", true); // ä½¿ç”¨ä¸¥æ ¼æ¨¡å¼
if (!momentDate.isValid()) {
    // å¦‚æœæ—¥æœŸæ— æ•ˆï¼Œåˆ™åœæ­¢æ¨¡æ¿å¹¶é€šçŸ¥ç”¨æˆ·
    new Notice("âŒ æ—¥æœŸæ ¼å¼æ— æ•ˆï¼Œè¯·ä½¿ç”¨ YYYY-MM-DD æ ¼å¼ã€‚");
    // ä½¿ç”¨ throw æ¥ä¸­æ–­æ¨¡æ¿æ‰§è¡Œï¼ŒObsidian ä¼šæ•è·å®ƒ
    throw new Error("Invalid date format");
}
// 2. ç”Ÿæˆæ–‡ä»¶åå’Œå…ƒæ•°æ®
// ä¼˜åŒ–æ–‡ä»¶åï¼ŒåŠ å…¥å¹´ä»½é¿å…å†²çªï¼š "2023-08-23"
const newFileName = momentDate.format("YYYY-MM-DD"); 
const titleName = momentDate.format("MM-DD"); // frontmatter é‡Œçš„ title ä¿æŒ MM-DD
// 3. å¹¶è¡Œè·å–ç½‘ç»œæ•°æ®ï¼ˆå¤©æ°”å’Œè¯—è¯ï¼‰ï¼Œæå‡é€Ÿåº¦
const [weather, dailyPoem] = await Promise.all([
    getWeather('yinchuan', 'é“¶å·'), // å¦‚æœéœ€è¦ï¼Œå¯ä»¥æ”¹æˆ prompt è®©ç”¨æˆ·è¾“å…¥
    getDailyPoem(tp)
]);
// 4. å®šä¹‰æ–‡ä»¶å…ƒæ•°æ®å’Œå†…å®¹
const modificationTime = tp.file.last_modified_date("HH:mm");
-%>
---
title: <% titleName %>
description: "<% titleName %> çš„ç”Ÿæ´»è®°å½•"
pubDate: <% momentDate.format("YYYY-MM-DD") %>
image: /images/blog/default.png
categories:
  - life
tags:
  - day
---
ğŸ“… **æ—¶é—´**: <% modificationTime %>
ğŸŒ¤ï¸ **å¤©æ°”**: <% weather %>

<% dailyPoem %>

## æ­£æ–‡

åœ¨è¿™é‡Œå†™ä¸‹ä»Šå¤©çš„æ•…äº‹...
<%*
// 5. ç§»åŠ¨æ–‡ä»¶åˆ°ç›®æ ‡ä½ç½®
// ä¿®æ­£äº†è·¯å¾„ï¼Œå»æ‰äº†å¼€å¤´çš„ "/"
const destDir = "blog/src/content/blog"; 
// ä½¿ç”¨åŒ…å«å¹´ä»½çš„æ–‡ä»¶å
await tp.file.move(destDir + "/" + newFileName); 
// å°†å…‰æ ‡å®šä½ï¼Œæ–¹ä¾¿ç«‹å³å¼€å§‹å†™ä½œ
tp.file.cursor();
-%>

```

