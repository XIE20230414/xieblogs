---
import { Icon } from "astro-icon/components";
import { USER_NAME, USER_SITE, USER_FOOTER_SOCIAL_ICONS } from "@config";
---

<div class="bg-transparent order-5" transition:name="footer">
  <footer class="footer bg-base-100 p-10 rounded-xl shadow-lg">
    <aside class="flex items-center space-x-4">
      <svg
        width="40"
        height="40"
        viewBox="0 0 24 24"
        xmlns="http://www.w3.org/2000/svg"
        fill-rule="evenodd"
        clip-rule="evenodd"
        class="fill-current cursor-pointer hover:scale-110 transition-transform"
        id="footer-easter-egg"
      >
        <title>点我有惊喜！</title>
        <path
          d="M22.672 15.226l-2.432.811.841 2.515c.33 1.019-.209 2.127-1.23 2.456-1.15.325-2.148-.321-2.463-1.226l-.84-2.518-5.013 1.677.84 2.517c.391 1.203-.434 2.542-1.831 2.542-.88 0-1.601-.564-1.86-1.314l-.842-2.516-2.431.809c-1.135.328-2.145-.317-2.463-1.229-.329-1.018.211-2.127 1.231-2.456l2.432-.809-1.621-4.823-2.432.808c-1.355.384-2.558-.59-2.558-1.839 0-.817.509-1.582 1.327-1.846l2.433-.809-.842-2.515c-.33-1.02.211-2.129 1.232-2.458 1.02-.329 2.13.209 2.461 1.229l.842 2.515 5.011-1.677-.839-2.517c-.403-1.238.484-2.553 1.843-2.553.819 0 1.585.509 1.85 1.326l.841 2.517 2.431-.81c1.02-.33 2.131.211 2.461 1.229.332 1.018-.21 2.126-1.23 2.456l-2.433.809 1.622 4.823 2.433-.809c1.242-.401 2.557.484 2.557 1.838 0 .819-.51 1.583-1.328 1.847m-8.992-6.428l-5.01 1.675 1.619 4.828 5.011-1.674-1.62-4.829z"
        ></path>
      </svg>
      <script is:inline>
        if (typeof window !== "undefined") {
          function bindEasterEgg() {
            const egg = document.getElementById("footer-easter-egg");
            if (!egg) return;
            // 防止重复绑定
            if (egg.dataset.easterBound) return;
            egg.dataset.easterBound = "1";
            let popup = null;
            let popupTimer = null;
            let fadeTimer = null;
            function showPopup(msg) {
              if (!popup) {
                popup = document.createElement("div");
                popup.className =
                  "fixed left-1/2 bottom-24 z-50 px-4 py-2 rounded-xl bg-base-200 text-base-content shadow-lg border border-base-300 animate-bounce-in flex items-center gap-2";
                popup.style.transform = "translateX(-50%)";
                document.body.appendChild(popup);
              } else {
                popup.classList.remove("animate-fade-out");
                popup.classList.add("animate-bounce-in");
              }
              popup.innerHTML = `<span class='text-2xl'>🎉</span><span>${msg}</span>`;
              if (popupTimer) clearTimeout(popupTimer);
              if (fadeTimer) clearTimeout(fadeTimer);
              popupTimer = setTimeout(() => {
                popup.classList.remove("animate-bounce-in");
                popup.classList.add("animate-fade-out");
                fadeTimer = setTimeout(() => {
                  if (popup) {
                    popup.remove();
                    popup = null;
                  }
                }, 800);
              }, 4000);
            }
            egg.addEventListener("click", function () {
              const tips = [
                "你发现了一个彩蛋！代码如诗，人生如歌。",
                "彩蛋：debug人生，bug也是风景。",
                "彩蛋：人生如代码，偶尔需要重启。",
                "彩蛋：函数有返回，人生有回响。",
                "彩蛋：哲学家说‘我思故我在’，程序员说‘while(true)我在’。",
                "彩蛋：生活像递归，别忘了出口。",
                "彩蛋：愿你的人生没有死循环，只有无限可能。",
                "彩蛋：幽默是最好的 try-catch。",
                "彩蛋：console.log(快乐)；",
                "彩蛋：祝你 bug-free！",
                "彩蛋：你是本站第N个发现彩蛋的人！(假的 不过我也不知道呢)",
              ];
              const tip = tips[Math.floor(Math.random() * tips.length)];
              showPopup(tip);
            });
          }
          document.addEventListener("DOMContentLoaded", bindEasterEgg);
          document.addEventListener("astro:page-load", bindEasterEgg);
        }
      </script>
      <style is:inline>
        @keyframes bounce-in {
          0% {
            opacity: 0;
            transform: translateX(-50%) scale(0.7);
          }
          60% {
            opacity: 1;
            transform: translateX(-50%) scale(1.1);
          }
          100% {
            opacity: 1;
            transform: translateX(-50%) scale(1);
          }
        }
        @keyframes fade-out {
          0% {
            opacity: 1;
          }
          100% {
            opacity: 0;
          }
        }
        .animate-bounce-in {
          animation: bounce-in 0.5s cubic-bezier(0.68, -0.55, 0.27, 1.55);
        }
        .animate-fade-out {
          animation: fade-out 0.8s ease forwards;
        }
      </style>
      <div>
        <p class="text-sm mb-1">
          © {new Date().getFullYear()} By <span class="font-bold text-primary">xiexienila</span>
        </p>
        <p class="text-sm mb-3">
          框架 <a href="https://docs.astro.build/" class="text-blue-600 hover:underline" target="_blank" rel="noopener"
            >Astro</a
          > | 主题 <a
            href="https://github.com/EveSunMaple/Frosti"
            class="text-blue-600 hover:underline"
            target="_blank"
            rel="noopener">FROSTI</a
          >
        </p>
      </div>
    </aside>
    <nav>
      <span class="footer-title">Social</span>
      <div class="grid grid-flow-col gap-4">
        {
          USER_FOOTER_SOCIAL_ICONS.map((icon) => (
            <div class="tooltip" data-tip={icon.title}>
              <a tabindex="0" href={icon.href} aria-label={icon.ariaLabel}>
                <Icon name={icon.svg} class="text-2xl md:text-xl" />
              </a>
            </div>
          ))
        }
        <div class="tooltip" data-tip="RSS Feed">
          <a tabindex="0" href="/rss.xml" aria-label="RSS Feed">
            <Icon name="ri:rss-line" class="text-2xl md:text-xl" />
          </a>
        </div>
      </div>
    </nav>
  </footer>
</div>
